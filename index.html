<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hommage Ã  Charnelle</title>

    <!-- Lien vers le CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

<nav>
    <a href="#accueil">Accueil</a>
    <a href="#fairepart">Faire-part</a>
    <a href="#programme">Programme</a>
    <a href="#adieux">Adieux</a>
    <a href="#fleurs">Offrir une fleur</a>
    <a href="#localisation">Localisation</a>
</nav>

<section id="accueil" class="section">
    <h1>Hommage Ã  NGOBI BAYEM Suzie Charnelle</h1>
    <img src="char.jpeg" class="photo" alt="Charnelle">
    <h2>Â« Une fille spÃ©ciale, une sÅ“ur aimante et une mÃ¨re dÃ©vouÃ©e Â»</h2>
</section>

<section id="fairepart" class="section">
    <h1>Faire-part</h1>
    <p>
        La grande famille <strong>Bayeka</strong>, la famille <strong>Bayem</strong>, 
        la famille <strong>Dalle</strong> et la famille <strong>Ndje</strong>
        annoncent avec une profonde tristesse le rappel Ã  Dieu de :
    </p>
    <h2><strong>NGOBI BAYEM Suzie Charnelle</strong></h2>
</section>

<section id="programme" class="section">
    <h1>Programme des obsÃ¨ques</h1>
    <ul style="list-style:none; padding:0; line-height:2;">
        <li>ğŸ“Œ VeillÃ©e â€” Date / Heure</li>
        <li>ğŸ“Œ LevÃ©e de corps â€” Date / Heure</li>
        <li>ğŸ“Œ Culte / Messe â€” Date / Heure</li>
        <li>ğŸ“Œ Inhumation â€” Date / Heure</li>
    </ul>
</section>

<section id="adieux" class="section">
    <h1>Adieux et messages</h1>
    <textarea id="message" rows="4" placeholder="Votre message dâ€™adieu..."></textarea>
    <button onclick="ajouterMessage()">Envoyer</button>
    <div id="messages"></div>
</section>

<section id="fleurs" class="section">
    <h1>Offrir une fleur ğŸŒ¸</h1>
    <button onclick="ajouterFleur()">DÃ©poser une fleur</button>
    <h3 id="compteur">Fleurs offertes : 0</h3>
    <div id="fleurs-zone"></div>
</section>

<section id="localisation" class="section">
    <h1>Localisation</h1>
    <div id="map">
        <img src="plan-de-localisation.jpeg" alt="Localisation">
    </div>
</section>

<!-- JavaScript intÃ©grÃ© -->
<script>
// Charger les messages depuis l'API
async function chargerMessages() {
    try {
        const response = await fetch('/api/messages');
        const messages = await response.json();
        const div = document.getElementById("messages");
        div.innerHTML = '';
        
        messages.forEach(msg => {
            const p = document.createElement("p");
            p.style.background = "#ffecec";
            p.style.padding = "10px";
            p.style.borderRadius = "10px";
            p.style.marginTop = "10px";
            p.textContent = msg.texte;
            div.appendChild(p);
        });
    } catch (error) {
        console.error('Erreur lors du chargement des messages:', error);
    }
}

// Charger les fleurs depuis l'API
async function chargerFleurs() {
    try {
        const response = await fetch('/api/fleurs');
        const fleurs = await response.json();
        const zone = document.getElementById("fleurs-zone");
        zone.innerHTML = '';
        
        fleurs.forEach(() => {
            const img = document.createElement("img");
            img.src = "rose.jpeg";
            img.style.width = "60px";
            img.style.margin = "8px";
            zone.appendChild(img);
        });
        
        document.getElementById("compteur").textContent = "Fleurs offertes : " + fleurs.length;
    } catch (error) {
        console.error('Erreur lors du chargement des fleurs:', error);
    }
}

// Ajouter un message
async function ajouterMessage() {
    const txt = document.getElementById("message").value.trim();
    if (!txt) return;

    try {
        const response = await fetch('/api/messages', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ message: txt })
        });

        if (response.ok) {
            document.getElementById("message").value = "";
            chargerMessages(); // Recharger les messages
        } else {
            alert('Erreur lors de l\'envoi du message');
        }
    } catch (error) {
        console.error('Erreur:', error);
        alert('Erreur lors de l\'envoi du message');
    }
}

// Ajouter une fleur
async function ajouterFleur() {
    try {
        const response = await fetch('/api/fleurs', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        });

        if (response.ok) {
            chargerFleurs(); // Recharger les fleurs
        } else {
            alert('Erreur lors du dÃ©pÃ´t de la fleur');
        }
    } catch (error) {
        console.error('Erreur:', error);
        alert('Erreur lors du dÃ©pÃ´t de la fleur');
    }
}

// Charger les donnÃ©es au chargement de la page
document.addEventListener('DOMContentLoaded', () => {
    chargerMessages();
    chargerFleurs();
});
</script>

</body>
</html>
